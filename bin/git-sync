#!/usr/bin/env bash

# https://github.com/git/git/blob/master/git-rebase.sh
remote="origin"
branch="master"
remoteBranch="$remote/$branch"
OPTIONS_STUCKLONG=t
OPTIONS_KEEPDASHDASH=
OPTIONS_SPEC="\
git sync [options]
--
 rebases current branch against $remoteBranch

 Available options are
s,sync!  fetch $remoteBranch from $remote before rebase
"

# https://www.kernel.org/pub/software/scm/git/docs/git-sh-setup.html
. "$(git --exec-path)/git-sh-setup"

total_argc=$#
while test $# != 0
do
	case "$1" in
	--sync)  sync=true;;
	--)
		shift
		break
		;;
	esac
	shift
done
# No positional arguments
test $# -ne 0 && usage

# Exit on error
set -e

if [ "$sync" = true ] ; then
    git fetch $remote $branch
fi

git rebase $remoteBranch
